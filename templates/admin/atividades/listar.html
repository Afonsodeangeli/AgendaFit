{% extends "base_privada.html" %}

{% block titulo %}Atividades{% endblock %}

{% block content %}
<!-- Cabeçalho Atividades Fitness -->
<div class="row mb-4">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h2 class="fw-bold" style="font-family: 'Montserrat', sans-serif; color: var(--fitness-green);">
                    <i class="bi bi-lightning-fill me-2 icon-green"></i>Atividades Físicas
                </h2>
                <p class="text-body-secondary mb-0">Cadastre e gerencie todas as atividades oferecidas</p>
            </div>
            <a href="/admin/atividades/cadastrar" class="btn btn-fitness-primary">
                <i class="bi bi-plus-circle me-1"></i> Nova Atividade
            </a>
        </div>
    </div>
</div>

{% if atividades %}
<!-- Grid de Atividades em Cards Visuais -->
<div class="row g-4">
    {% for atividade in atividades %}
    <div class="col-md-6 col-lg-4">
        <div class="card card-fitness h-100 bg-body overflow-hidden d-flex flex-column">
            <!-- Header do Card com Ícone Fitness -->
            <div style="background: linear-gradient(135deg, #1AA260 0%, #00BCD4 100%); height: 100px; display: flex; align-items: center; justify-content: center; color: white;">
                <i class="bi bi-heart-pulse" style="font-size: 3rem; opacity: 0.8;"></i>
            </div>

            <div class="card-body flex-grow-1 d-flex flex-column">
                <!-- Nome da Atividade -->
                <h5 class="card-title fw-bold mb-2" style="color: var(--fitness-green);">
                    {{ atividade.nome }}
                </h5>

                <!-- Categoria Badge -->
                {% if atividade.categoria_nome %}
                <div class="mb-3">
                    <span class="badge-fitness-green rounded-pill" style="display: inline-block;">
                        <i class="bi bi-tag me-1"></i>{{ atividade.categoria_nome }}
                    </span>
                </div>
                {% endif %}

                <!-- Descrição -->
                <p class="card-text text-body-secondary mb-auto" style="font-size: 0.95rem; line-height: 1.5;">
                    {% if atividade.descricao %}
                    {{ atividade.descricao[:120] }}{% if atividade.descricao|length > 120 %}...{% endif %}
                    {% else %}
                    <em class="text-muted">Sem descrição</em>
                    {% endif %}
                </p>

                <!-- Ações -->
                <div class="btn-group w-100 mt-4" role="group">
                    <a href="/admin/atividades/editar/{{ atividade.id_atividade }}"
                       class="btn btn-sm btn-fitness-secondary"
                       title="Editar atividade">
                        <i class="bi bi-pencil"></i> Editar
                    </a>
                    <button type="button"
                            class="btn btn-sm btn-outline-danger"
                            title="Excluir atividade"
                            data-id="{{ atividade.id_atividade }}"
                            data-nome="{{ atividade.nome|e }}"
                            onclick="excluirAtividadeElement(this)">
                        <i class="bi bi-trash"></i> Excluir
                    </button>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- Rodapé com Total -->
<div class="row mt-4">
    <div class="col-12">
        <div class="alert border-0 rounded-3" style="background: rgba(0, 78, 137, 0.1); border-left: 4px solid var(--fitness-blue);">
            <i class="bi bi-info-circle me-2 icon-blue fw-bold"></i>
            <strong>Total:</strong> {{ atividades|length }} atividade(s) cadastrada(s)
        </div>
    </div>
</div>

{% else %}
<!-- Estado Vazio -->
<div class="row">
    <div class="col-md-8 mx-auto">
        <div class="card card-fitness border-0 shadow-sm" style="padding: 60px 20px; text-align: center;">
            <i class="bi bi-inbox" style="font-size: 4rem; color: var(--fitness-green); opacity: 0.3; margin-bottom: 20px;"></i>
            <h4 class="fw-bold text-body-secondary mb-2">Nenhuma atividade cadastrada</h4>
            <p class="text-body-secondary mb-4">
                Comece criando sua primeira atividade para oferecer aos seus alunos.
            </p>
            <a href="/admin/atividades/cadastrar" class="btn btn-fitness-primary">
                <i class="bi bi-plus-circle"></i> Cadastrar Primeira Atividade
            </a>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
/**
 * Abre modal de confirmação para excluir atividade
 */
function excluirAtividadeElement(el) {
    const atividadeId = el.dataset.id;
    const atividadeNome = el.dataset.nome;
    const detalhes = `
        <div class="card bg-light">
            <div class="card-body">
                <h6 class="card-title mb-2">
                    <i class="bi bi-activity"></i> Atividade:
                </h6>
                <p class="mb-0"><strong>${atividadeNome}</strong></p>
            </div>
        </div>
        <div class="alert alert-warning mt-3 mb-0">
            <i class="bi bi-exclamation-triangle"></i>
            <strong>Atenção:</strong> Esta ação não pode ser desfeita.
            Todas as turmas associadas a esta atividade poderão ser afetadas.
        </div>
    `;

    abrirModalConfirmacao({
        url: `/admin/atividades/${atividadeId}/excluir`,
        mensagem: 'Tem certeza que deseja excluir esta atividade?',
        detalhes: detalhes
    });
}
</script>
{% endblock %}