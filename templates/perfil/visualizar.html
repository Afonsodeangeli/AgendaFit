{% extends "base_privada.html" %}

{% block titulo %}Meu Perfil{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row">
        <div class="col-md-8 mx-auto">
            <!-- Cabeçalho do Perfil -->
            <div class="card shadow-sm mb-4">
                <div class="card-body text-center py-5">
                    <div class="mb-4">
                        <img src="{{ usuario.id|foto_usuario }}" alt="Foto de Perfil"
                            class="rounded-circle border border-3 border-primary" width="150" height="150"
                            style="object-fit: cover;">
                    </div>

                    <h2 class="mb-2">{{ usuario.nome }}</h2>
                    <p class="text-muted mb-3">
                        <i class="bi bi-envelope"></i> {{ usuario.email }}
                    </p>
                    <p class="mb-3">
                        <span
                            class="badge bg-{% if usuario.perfil == 'Administrador' %}danger{% else %}info{% endif %} px-3 py-2">
                            <i class="bi bi-person-badge"></i>
                            {{ usuario.perfil }}
                        </span>
                    </p>
                    {% if usuario.data_cadastro %}
                    <p class="text-muted small">
                        <i class="bi bi-calendar-check"></i> Membro desde {{ usuario.data_cadastro|data_br }}
                    </p>
                    {% endif %}
                </div>
            </div>
            <!-- Ações do Perfil -->
            <div class="row g-3 mb-4">
                <div class="col-md-4">
                    <a href="/perfil/editar" class="btn btn-primary w-100">
                        <i class="bi bi-pencil-square"></i> Editar Dados
                    </a>
                </div>
                <div class="col-md-4">
                    <a href="/perfil/alterar-senha" class="btn btn-warning w-100">
                        <i class="bi bi-key-fill"></i> Alterar Senha
                    </a>
                </div>
                <div class="col-md-4">
                    <button type="button" class="btn btn-info w-100" data-bs-toggle="modal" data-bs-target="#modalFotoPerfil">
                        <i class="bi bi-camera-fill"></i> Alterar Foto
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Crop de Foto -->
{% set modal_id = "modalFotoPerfil" %}
{% set modal_title = "Alterar Foto de Perfil" %}
{% set form_action = "/perfil/atualizar-foto" %}
{% set aspect_ratio = 1.0 %}
{% set max_file_size_mb = 5 %}
{% include 'components/modal_crop_imagem.html' %}
{% endblock %}

{% block scripts %}
<!-- Cropper.js CSS e JS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.js"></script>

<!-- Image Cropper Component -->
<script src="/static/js/image-cropper.js"></script>
{% endblock %}